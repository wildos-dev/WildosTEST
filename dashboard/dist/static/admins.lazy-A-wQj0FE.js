import{j as e,r as u}from"./react-core-Bcdk_OeX.js";import{A as i,a_ as f,a$ as g,M as N,ap as _,aP as C,aq as S,aQ as w,I as j,a5 as A,a6 as $,a7 as I,a8 as P,a9 as k,aa as m,j as E,b0 as K,b1 as F,Z as T}from"./index-D9xJNTt9.js";import"./layout-Y81SaLgb.js";import{aK as r,d as b}from"./react-ecosystem-DA9e0y3F.js";import"./dnd-kit-BufO2FBr.js";import{u as D,h as Q,O as R}from"./router-BzWBhOx2.js";import{P as O}from"./index-d4rf_bwY.js";import{E as B}from"./entity-table-B7On41yN.js";import{N as H}from"./index-Cvb6BIEQ.js";import{S as L}from"./index-BqxW2es5.js";import"./monaco-D6sUsa5W.js";import"./styling-utils--BulIq_u.js";import"./network-3TAtD9nM.js";import"./forms-D7oth6Cp.js";import"./search-CgVhiaN-.js";import"./query-BGTG4bZD.js";import"./state-BNTuQEE6.js";import"./date-utils-hmeNWewA.js";import"./table-DQ5QIWK1.js";import"./recharts-CPh6Hnhc.js";const V=a=>[{accessorKey:"username",header:({column:s})=>e.jsx(i,{title:r.t("username"),column:s})},{accessorKey:"subscription_url_prefix",header:({column:s})=>e.jsx(i,{title:r.t("url_prefix"),column:s,className:"hidden sm:table-cell"}),cell:({row:s})=>{const t=s.original;return t?.subscription_url_prefix?e.jsx("span",{className:"hidden sm:table-cell text-sm",children:t.subscription_url_prefix}):e.jsx("span",{className:"hidden sm:table-cell text-muted-foreground",children:"-"})}},{accessorKey:"is_sudo",header:({column:s})=>e.jsx(i,{title:r.t("page.admins.permission"),column:s}),cell:({row:s})=>{const t=s.original;return t?e.jsx(f,{admin:t}):null}},{accessorKey:"enabled",enableSorting:!1,header:({column:s})=>e.jsx(i,{title:r.t("status"),column:s}),cell:({row:s})=>{const t=s.original;return t?e.jsx(g,{admin:t}):null}},{accessorKey:"users_data_usage",header:({column:s})=>e.jsx(i,{title:r.t("usage"),column:s,className:"hidden md:table-cell"}),cell:({row:s})=>{const n=s.original?.users_data_usage||0;return e.jsx("span",{className:"hidden md:table-cell text-sm text-muted-foreground",children:n>0?`${n} users`:"-"})}},{id:"actions",cell:({row:s})=>e.jsx(H,{row:s,actions:a,children:e.jsx(N,{...a,row:s})})}],q=({entity:a,actions:s,onRowClick:t})=>{const n=()=>{t?.(a)},d=c=>{c.stopPropagation()};return e.jsxs(_,{className:"w-full cursor-pointer hover:bg-muted/50 transition-colors",onClick:n,"data-testid":`card-admin-${a.username}`,children:[e.jsx(C,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:e.jsx("span",{className:"font-medium truncate","data-testid":`text-username-${a.username}`,children:a.username})}),e.jsx(f,{admin:a})]})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:r.t("status")}),e.jsx(g,{admin:a})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:r.t("url_prefix")}),e.jsx("div",{className:"text-sm","data-testid":`text-url-prefix-${a.username}`,children:a?.subscription_url_prefix||e.jsx("span",{className:"text-muted-foreground",children:"-"})})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:r.t("usage")}),e.jsx("div",{className:"text-sm text-muted-foreground","data-testid":`text-usage-${a.username}`,children:a?.users_data_usage&&a.users_data_usage>0?`${a.users_data_usage} users`:"-"})]})]}),e.jsx(w,{className:"pt-2",onClick:d,children:e.jsx("div",{className:"flex items-center justify-end w-full",children:e.jsx(N,{...s,row:{original:a},className:"w-auto justify-end"})})})]})},z=()=>{const a=D({from:"/admins"}),{t:s}=b(),[t,n]=u.useState(""),[d,c]=u.useState("all"),o=l=>{a({to:"/admins/$adminId",params:{adminId:l.username}})},x=l=>{a({to:"/admins/$adminId/edit",params:{adminId:l.username}})},p=l=>{a({to:"/admins/$adminId/delete",params:{adminId:l.username}})},h=()=>{a({to:"/admins/create"})},v=V({onEdit:x,onDelete:p,onOpen:o}),y={onEdit:x,onDelete:p,onOpen:o};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(j,{name:"Search",className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(A,{placeholder:s("placeholders.search-filter"),value:t,onChange:l=>n(l.target.value),className:"pl-10","data-testid":"input-search-admins"})]}),e.jsxs($,{value:d,onValueChange:c,children:[e.jsx(I,{className:"w-48","data-testid":"select-status-filter",children:e.jsx(P,{placeholder:s("status")})}),e.jsxs(k,{children:[e.jsx(m,{value:"all","data-testid":"select-option-all",children:"All"}),e.jsx(m,{value:"enabled","data-testid":"select-option-enabled",children:"Enabled"}),e.jsx(m,{value:"disabled","data-testid":"select-option-disabled",children:"Disabled"})]})]})]}),e.jsxs(E,{onClick:h,className:"shrink-0","data-testid":"button-create-admin",children:[e.jsx(j,{name:"Plus",className:"h-4 w-4 mr-2"}),s("create")]})]}),e.jsx(B,{fetchEntity:F,columns:v,primaryFilter:"username",entityKey:K,onCreate:h,onOpen:o,CardComponent:q,cardActions:y})]})},M=()=>{const{t:a}=b();return e.jsxs(O,{title:a("admins"),children:[e.jsx(z,{}),e.jsx(u.Suspense,{fallback:e.jsx(T,{}),children:e.jsx(R,{})})]})},xe=Q("/_dashboard/admins")({component:()=>e.jsx(L,{children:e.jsx(M,{})})});export{M as AdminsPage,xe as Route};
